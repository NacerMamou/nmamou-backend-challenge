
DROP TABLE IF EXISTS categories_closure;
DROP TABLE IF EXISTS volumes;
DROP TABLE IF EXISTS categories;


CREATE TABLE categories (
  id INTEGER PRIMARY KEY DEFAULT NULL,
  name TEXT,
  parent_id INTEGER,
  FOREIGN KEY (parent_id) REFERENCES categories (id));

CREATE TABLE categories_closure (
  ancestor_id INTEGER,
  descendant_id INTEGER,
  FOREIGN KEY (ancestor_id) REFERENCES categories (id),
  FOREIGN KEY (descendant_id) REFERENCES categories (id));

CREATE TABLE volumes(
  category_id INTEGER,
  date DATE,
  volume INTEGER,
  FOREIGN KEY (category_id) REFERENCES categories (id));


INSERT INTO categories VALUES
  ( 250162, 'Products', DEFAULT ),
  ( 250222, 'Spread', 250162 ),
  ( 250224, 'Breakfast', 250162 ),  
  ( 250301, 'Honey', 250222 ),
  ( 250303, 'Breakfast bread', 250224 ),
  ( 250328, 'Butter', 250222 ),
  ( 250332, 'Breakfast cereal', 250224 ),
  ( 250333, 'Other nuts spread', 250222 ),
  ( 250378, 'Jam', 250222 ),
  ( 253921, 'Yeast extract', 250222 ),
  ( 258361, 'Hazelnut & cocoa spread', 250222 ),
  ( 274714, 'Chocolate candy and praline', 250162 ),
  ( 274734, 'Praline', 274714 ),
  ( 274736, 'Chocolate candy', 274714 );


INSERT INTO categories_closure VALUES
  ( 250162, 250162 ),
  ( 250162, 250222 ),
  ( 250222, 250222 ),
  ( 250162, 250224 ),
  ( 250224, 250224 ),
  ( 250162, 274714 ),
  ( 274714, 274714 ),
  ( 250162, 250301 ),
  ( 250222, 250301 ),
  ( 250301, 250301 ),
  ( 250162, 250303 ),
  ( 250224, 250303 ),
  ( 250303, 250303 ),
  ( 250162, 250328 ),
  ( 250222, 250328 ),
  ( 250328, 250328 ),
  ( 250162, 250332 ),
  ( 250224, 250332 ),
  ( 250332, 250332 ),
  ( 250162, 250333 ),
  ( 250222, 250333 ),
  ( 250333, 250333 ),
  ( 250162, 250378 ),
  ( 250222, 250378 ),
  ( 250378, 250378 ),
  ( 250162, 274734 ),
  ( 274714, 274734 ),
  ( 274734, 274734 ),
  ( 250162, 274736 ),
  ( 274714, 274736 ),
  ( 274736, 274736 ),
  ( 250162, 253921 ),
  ( 250222, 253921 ),
  ( 253921, 253921 ),
  ( 250162, 258361 ),
  ( 250222, 258361 ),
  ( 258361, 258361 );


INSERT INTO volumes VALUES
	(250301, '2018-07-01', 165890),
	(250301, '2018-08-01', 231780),
	(250301, '2018-09-01', 177260),
	(250301, '2018-10-01', 209610),
	(250301, '2018-11-01', 207770),
	(250301, '2018-12-01', 190000),
	(250301, '2019-01-01', 221570),
	(250301, '2019-02-01', 196690),
	(250301, '2019-03-01', 217080),
	(250301, '2019-04-01', 239080),
	(250301, '2019-05-01', 244300),
	(250301, '2019-06-01', 249630),
	(250301, '2019-07-01', 268670),
	(250301, '2019-08-01', 285940),
	(250301, '2019-09-01', 306070),
	(250301, '2019-10-01', 275500),
	(250301, '2019-11-01', 367060),
	(250301, '2019-12-01', 361570),
	(250301, '2020-01-01', 342890),
	(250301, '2020-02-01', 320880),
	(250301, '2020-03-01', 371910),
	(250301, '2020-04-01', 542870),
	(250301, '2020-05-01', 506090),
	(250301, '2020-06-01', 456620),
	(250301, '2020-07-01', 375840),
	(250301, '2020-08-01', 353740),
	(250301, '2020-09-01', 308510),
	(250301, '2020-10-01', 334980),
	(250301, '2020-11-01', 368000),
	(250301, '2020-12-01', 303860),
	(250301, '2021-01-01', 401760),
	(250301, '2021-02-01', 318350),
	(250301, '2021-03-01', 286120),
	(250301, '2021-04-01', 293370),
	(250301, '2021-05-01', 264310),
	(250301, '2021-06-01', 284750),
	(250301, '2021-07-01', 272560),
	(250301, '2021-08-01', 305330),
	(250301, '2021-09-01', 271520),
	(250301, '2021-10-01', 286780),
	(250301, '2021-11-01', 291770),
	(250301, '2021-12-01', 254710),
	(250301, '2022-01-01', 268600),
	(250301, '2022-02-01', 221930),
	(250301, '2022-03-01', 260790),
	(250301, '2022-04-01', 254410),
	(250301, '2022-05-01', 289390),
	(250301, '2022-06-01', 314300),
	(250303, '2018-07-01', 334370),
	(250303, '2018-08-01', 365060),
	(250303, '2018-09-01', 404430),
	(250303, '2018-10-01', 428850),
	(250303, '2018-11-01', 419500),
	(250303, '2018-12-01', 487360),
	(250303, '2019-01-01', 432960),
	(250303, '2019-02-01', 406860),
	(250303, '2019-03-01', 494170),
	(250303, '2019-04-01', 387760),
	(250303, '2019-05-01', 388470),
	(250303, '2019-06-01', 408230),
	(250303, '2019-07-01', 443800),
	(250303, '2019-08-01', 426380),
	(250303, '2019-09-01', 502230),
	(250303, '2019-10-01', 526620),
	(250303, '2019-11-01', 557880),
	(250303, '2019-12-01', 481240),
	(250303, '2020-01-01', 560620),
	(250303, '2020-02-01', 541900),
	(250303, '2020-03-01', 731260),
	(250303, '2020-04-01', 985940),
	(250303, '2020-05-01', 875770),
	(250303, '2020-06-01', 662240),
	(250303, '2020-07-01', 565290),
	(250303, '2020-08-01', 506250),
	(250303, '2020-09-01', 576060),
	(250303, '2020-10-01', 691630),
	(250303, '2020-11-01', 952490),
	(250303, '2020-12-01', 690460),
	(250303, '2021-01-01', 770580),
	(250303, '2021-02-01', 702740),
	(250303, '2021-03-01', 645650),
	(250303, '2021-04-01', 628180),
	(250303, '2021-05-01', 611410),
	(250303, '2021-06-01', 459070),
	(250303, '2021-07-01', 506390),
	(250303, '2021-08-01', 497940),
	(250303, '2021-09-01', 526380),
	(250303, '2021-10-01', 572610),
	(250303, '2021-11-01', 569530),
	(250303, '2021-12-01', 553370),
	(250303, '2022-01-01', 588860),
	(250303, '2022-02-01', 558150),
	(250303, '2022-03-01', 603230),
	(250303, '2022-04-01', 519170),
	(250303, '2022-05-01', 544880),
	(250303, '2022-06-01', 423424),
	(250328, '2018-07-01', 122970),
	(250328, '2018-08-01', 96860),
	(250328, '2018-09-01', 100760),
	(250328, '2018-10-01', 110450),
	(250328, '2018-11-01', 94200),
	(250328, '2018-12-01', 86470),
	(250328, '2019-01-01', 116730),
	(250328, '2019-02-01', 100950),
	(250328, '2019-03-01', 119360),
	(250328, '2019-04-01', 100880),
	(250328, '2019-05-01', 106020),
	(250328, '2019-06-01', 103140),
	(250328, '2019-07-01', 108100),
	(250328, '2019-08-01', 111180),
	(250328, '2019-09-01', 129800),
	(250328, '2019-10-01', 137530),
	(250328, '2019-11-01', 144120),
	(250328, '2019-12-01', 114510),
	(250328, '2020-01-01', 151340),
	(250328, '2020-02-01', 140110),
	(250328, '2020-03-01', 180290),
	(250328, '2020-04-01', 298620),
	(250328, '2020-05-01', 285680),
	(250328, '2020-06-01', 190950),
	(250328, '2020-07-01', 165210),
	(250328, '2020-08-01', 142390),
	(250328, '2020-09-01', 131510),
	(250328, '2020-10-01', 170770),
	(250328, '2020-11-01', 175950),
	(250328, '2020-12-01', 156510),
	(250328, '2021-01-01', 226060),
	(250328, '2021-02-01', 216840),
	(250328, '2021-03-01', 185170),
	(250328, '2021-04-01', 150610),
	(250328, '2021-05-01', 168930),
	(250328, '2021-06-01', 131180),
	(250328, '2021-07-01', 140110),
	(250328, '2021-08-01', 139970),
	(250328, '2021-09-01', 131840),
	(250328, '2021-10-01', 144190),
	(250328, '2021-11-01', 148780),
	(250328, '2021-12-01', 141090),
	(250328, '2022-01-01', 160730),
	(250328, '2022-02-01', 146580),
	(250328, '2022-03-01', 154240),
	(250328, '2022-04-01', 149070),
	(250328, '2022-05-01', 150170),
	(250328, '2022-06-01', 123163),
	(250332, '2018-07-01', 103940),
	(250332, '2018-08-01', 106210),
	(250332, '2018-09-01', 117190),
	(250332, '2018-10-01', 133290),
	(250332, '2018-11-01', 111470),
	(250332, '2018-12-01', 85030),
	(250332, '2019-01-01', 167500),
	(250332, '2019-02-01', 139740),
	(250332, '2019-03-01', 158540),
	(250332, '2019-04-01', 136460),
	(250332, '2019-05-01', 146120),
	(250332, '2019-06-01', 147350),
	(250332, '2019-07-01', 155470),
	(250332, '2019-08-01', 156990),
	(250332, '2019-09-01', 171970),
	(250332, '2019-10-01', 166880),
	(250332, '2019-11-01', 157380),
	(250332, '2019-12-01', 117440),
	(250332, '2020-01-01', 222010),
	(250332, '2020-02-01', 202380),
	(250332, '2020-03-01', 239580),
	(250332, '2020-04-01', 271920),
	(250332, '2020-05-01', 265470),
	(250332, '2020-06-01', 266470),
	(250332, '2020-07-01', 207430),
	(250332, '2020-08-01', 187380),
	(250332, '2020-09-01', 197430),
	(250332, '2020-10-01', 202850),
	(250332, '2020-11-01', 197950),
	(250332, '2020-12-01', 142140),
	(250332, '2021-01-01', 276180),
	(250332, '2021-02-01', 276480),
	(250332, '2021-03-01', 241380),
	(250332, '2021-04-01', 196530),
	(250332, '2021-05-01', 191580),
	(250332, '2021-06-01', 178230),
	(250332, '2021-07-01', 179930),
	(250332, '2021-08-01', 173510),
	(250332, '2021-09-01', 180930),
	(250332, '2021-10-01', 186090),
	(250332, '2021-11-01', 179310),
	(250332, '2021-12-01', 139800),
	(250332, '2022-01-01', 233040),
	(250332, '2022-02-01', 201510),
	(250332, '2022-03-01', 199690),
	(250332, '2022-04-01', 187550),
	(250332, '2022-05-01', 193900),
	(250332, '2022-06-01', 181407),
	(250333, '2018-07-01', 138190),
	(250333, '2018-08-01', 152920),
	(250333, '2018-09-01', 149660),
	(250333, '2018-10-01', 166390),
	(250333, '2018-11-01', 154290),
	(250333, '2018-12-01', 118560),
	(250333, '2019-01-01', 193750),
	(250333, '2019-02-01', 176760),
	(250333, '2019-03-01', 199400),
	(250333, '2019-04-01', 173680),
	(250333, '2019-05-01', 183500),
	(250333, '2019-06-01', 176240),
	(250333, '2019-07-01', 192090),
	(250333, '2019-08-01', 195610),
	(250333, '2019-09-01', 191840),
	(250333, '2019-10-01', 195120),
	(250333, '2019-11-01', 191920),
	(250333, '2019-12-01', 152090),
	(250333, '2020-01-01', 242000),
	(250333, '2020-02-01', 263530),
	(250333, '2020-03-01', 268060),
	(250333, '2020-04-01', 437280),
	(250333, '2020-05-01', 545320),
	(250333, '2020-06-01', 407940),
	(250333, '2020-07-01', 340030),
	(250333, '2020-08-01', 302220),
	(250333, '2020-09-01', 268770),
	(250333, '2020-10-01', 286470),
	(250333, '2020-11-01', 280230),
	(250333, '2020-12-01', 213050),
	(250333, '2021-01-01', 364470),
	(250333, '2021-02-01', 363810),
	(250333, '2021-03-01', 328790),
	(250333, '2021-04-01', 266320),
	(250333, '2021-05-01', 269590),
	(250333, '2021-06-01', 214820),
	(250333, '2021-07-01', 214260),
	(250333, '2021-08-01', 218680),
	(250333, '2021-09-01', 208330),
	(250333, '2021-10-01', 209450),
	(250333, '2021-11-01', 194740),
	(250333, '2021-12-01', 163530),
	(250333, '2022-01-01', 253150),
	(250333, '2022-02-01', 222720),
	(250333, '2022-03-01', 234466),
	(250333, '2022-04-01', 214666),
	(250333, '2022-05-01', 225770),
	(250333, '2022-06-01', 193331),
	(250378, '2018-07-01', 44340),
	(250378, '2018-08-01', 110780),
	(250378, '2018-09-01', 113690),
	(250378, '2018-10-01', 32450),
	(250378, '2018-11-01', 16550),
	(250378, '2018-12-01', 12030),
	(250378, '2019-01-01', 9130),
	(250378, '2019-02-01', 9960),
	(250378, '2019-03-01', 10900),
	(250378, '2019-04-01', 10240),
	(250378, '2019-05-01', 12130),
	(250378, '2019-06-01', 21520),
	(250378, '2019-07-01', 41120),
	(250378, '2019-08-01', 101080),
	(250378, '2019-09-01', 101230),
	(250378, '2019-10-01', 31300),
	(250378, '2019-11-01', 34690),
	(250378, '2019-12-01', 16400),
	(250378, '2020-01-01', 12990),
	(250378, '2020-02-01', 13680),
	(250378, '2020-03-01', 18850),
	(250378, '2020-04-01', 31880),
	(250378, '2020-05-01', 33540),
	(250378, '2020-06-01', 48880),
	(250378, '2020-07-01', 82090),
	(250378, '2020-08-01', 213740),
	(250378, '2020-09-01', 109210),
	(250378, '2020-10-01', 40870),
	(250378, '2020-11-01', 27840),
	(250378, '2020-12-01', 20000),
	(250378, '2021-01-01', 19610),
	(250378, '2021-02-01', 19200),
	(250378, '2021-03-01', 18540),
	(250378, '2021-04-01', 15260),
	(250378, '2021-05-01', 15770),
	(250378, '2021-06-01', 20410),
	(250378, '2021-07-01', 31520),
	(250378, '2021-08-01', 62230),
	(250378, '2021-09-01', 84420),
	(250378, '2021-10-01', 31000),
	(250378, '2021-11-01', 18810),
	(250378, '2021-12-01', 17420),
	(250378, '2022-01-01', 16280),
	(250378, '2022-02-01', 16130),
	(250378, '2022-03-01', 16050),
	(250378, '2022-04-01', 15290),
	(250378, '2022-05-01', 18490),
	(250378, '2022-06-01', 24512),
	(274734, '2018-07-01', 55220),
	(274734, '2018-08-01', 66960),
	(274734, '2018-09-01', 66490),
	(274734, '2018-10-01', 81820),
	(274734, '2018-11-01', 152700),
	(274734, '2018-12-01', 218530),
	(274734, '2019-01-01', 101780),
	(274734, '2019-02-01', 94900),
	(274734, '2019-03-01', 98400),
	(274734, '2019-04-01', 85020),
	(274734, '2019-05-01', 65870),
	(274734, '2019-06-01', 66530),
	(274734, '2019-07-01', 78390),
	(274734, '2019-08-01', 69620),
	(274734, '2019-09-01', 81430),
	(274734, '2019-10-01', 102980),
	(274734, '2019-11-01', 184760),
	(274734, '2019-12-01', 264650),
	(274734, '2020-01-01', 120370),
	(274734, '2020-02-01', 117040),
	(274734, '2020-03-01', 95330),
	(274734, '2020-04-01', 122880),
	(274734, '2020-05-01', 128470),
	(274734, '2020-06-01', 110250),
	(274734, '2020-07-01', 105750),
	(274734, '2020-08-01', 91710),
	(274734, '2020-09-01', 86930),
	(274734, '2020-10-01', 127130),
	(274734, '2020-11-01', 245600),
	(274734, '2020-12-01', 385420),
	(274734, '2021-01-01', 181090),
	(274734, '2021-02-01', 188170),
	(274734, '2021-03-01', 190760),
	(274734, '2021-04-01', 121350),
	(274734, '2021-05-01', 101930),
	(274734, '2021-06-01', 80960),
	(274734, '2021-07-01', 94650),
	(274734, '2021-08-01', 104550),
	(274734, '2021-09-01', 100390),
	(274734, '2021-10-01', 119090),
	(274734, '2021-11-01', 189310),
	(274734, '2021-12-01', 276320),
	(274734, '2022-01-01', 134260),
	(274734, '2022-02-01', 115820),
	(274734, '2022-03-01', 118410),
	(274734, '2022-04-01', 142240),
	(274734, '2022-05-01', 105640),
	(274734, '2022-06-01', 87326),
	(274736, '2018-07-01', 150910),
	(274736, '2018-08-01', 210210),
	(274736, '2018-09-01', 184480),
	(274736, '2018-10-01', 260690),
	(274736, '2018-11-01', 548330),
	(274736, '2018-12-01', 810530),
	(274736, '2019-01-01', 406350),
	(274736, '2019-02-01', 292960),
	(274736, '2019-03-01', 294990),
	(274736, '2019-04-01', 407780),
	(274736, '2019-05-01', 184940),
	(274736, '2019-06-01', 195740),
	(274736, '2019-07-01', 213950),
	(274736, '2019-08-01', 186500),
	(274736, '2019-09-01', 295990),
	(274736, '2019-10-01', 340960),
	(274736, '2019-11-01', 688620),
	(274736, '2019-12-01', 1049280),
	(274736, '2020-01-01', 336170),
	(274736, '2020-02-01', 321730),
	(274736, '2020-03-01', 568380),
	(274736, '2020-04-01', 995430),
	(274736, '2020-05-01', 530000),
	(274736, '2020-06-01', 410640),
	(274736, '2020-07-01', 295980),
	(274736, '2020-08-01', 260600),
	(274736, '2020-09-01', 410050),
	(274736, '2020-10-01', 753130),
	(274736, '2020-11-01', 1401590),
	(274736, '2020-12-01', 1735400),
	(274736, '2021-01-01', 641050),
	(274736, '2021-02-01', 736370),
	(274736, '2021-03-01', 1027600),
	(274736, '2021-04-01', 417270),
	(274736, '2021-05-01', 414490),
	(274736, '2021-06-01', 339190),
	(274736, '2021-07-01', 319430),
	(274736, '2021-08-01', 359730),
	(274736, '2021-09-01', 439310),
	(274736, '2021-10-01', 649310),
	(274736, '2021-11-01', 1135380),
	(274736, '2021-12-01', 1496900),
	(274736, '2022-01-01', 547320),
	(274736, '2022-02-01', 439830),
	(274736, '2022-03-01', 512820),
	(274736, '2022-04-01', 707280),
	(274736, '2022-05-01', 361560),
	(274736, '2022-06-01', 296546),
	(253921, '2018-07-01', 26540),
	(253921, '2018-08-01', 27380),
	(253921, '2018-09-01', 33500),
	(253921, '2018-10-01', 39920),
	(253921, '2018-11-01', 39790),
	(253921, '2018-12-01', 32620),
	(253921, '2019-01-01', 34040),
	(253921, '2019-02-01', 33870),
	(253921, '2019-03-01', 134180),
	(253921, '2019-04-01', 78480),
	(253921, '2019-05-01', 52230),
	(253921, '2019-06-01', 46250),
	(253921, '2019-07-01', 67340),
	(253921, '2019-08-01', 53150),
	(253921, '2019-09-01', 50770),
	(253921, '2019-10-01', 73690),
	(253921, '2019-11-01', 58000),
	(253921, '2019-12-01', 55820),
	(253921, '2020-01-01', 76120),
	(253921, '2020-02-01', 96030),
	(253921, '2020-03-01', 72130),
	(253921, '2020-04-01', 71620),
	(253921, '2020-05-01', 84190),
	(253921, '2020-06-01', 75980),
	(253921, '2020-07-01', 57340),
	(253921, '2020-08-01', 65200),
	(253921, '2020-09-01', 60980),
	(253921, '2020-10-01', 62690),
	(253921, '2020-11-01', 80410),
	(253921, '2020-12-01', 55160),
	(253921, '2021-01-01', 57000),
	(253921, '2021-02-01', 67930),
	(253921, '2021-03-01', 94920),
	(253921, '2021-04-01', 53610),
	(253921, '2021-05-01', 53250),
	(253921, '2021-06-01', 37340),
	(253921, '2021-07-01', 36740),
	(253921, '2021-08-01', 37230),
	(253921, '2021-09-01', 38690),
	(253921, '2021-10-01', 45470),
	(253921, '2021-11-01', 46620),
	(253921, '2021-12-01', 45230),
	(253921, '2022-01-01', 54220),
	(253921, '2022-02-01', 43830),
	(253921, '2022-03-01', 43760),
	(253921, '2022-04-01', 44020),
	(253921, '2022-05-01', 51960),
	(253921, '2022-06-01', 36440),
	(258361, '2018-07-01', 80160),
	(258361, '2018-08-01', 92420),
	(258361, '2018-09-01', 98710),
	(258361, '2018-10-01', 105940),
	(258361, '2018-11-01', 131400),
	(258361, '2018-12-01', 133700),
	(258361, '2019-01-01', 103880),
	(258361, '2019-02-01', 116590),
	(258361, '2019-03-01', 132510),
	(258361, '2019-04-01', 85750),
	(258361, '2019-05-01', 86300),
	(258361, '2019-06-01', 90150),
	(258361, '2019-07-01', 90660),
	(258361, '2019-08-01', 94622),
	(258361, '2019-09-01', 110570),
	(258361, '2019-10-01', 112187),
	(258361, '2019-11-01', 147661),
	(258361, '2019-12-01', 148891),
	(258361, '2020-01-01', 125192),
	(258361, '2020-02-01', 174742),
	(258361, '2020-03-01', 182487),
	(258361, '2020-04-01', 317655),
	(258361, '2020-05-01', 333884),
	(258361, '2020-06-01', 225524),
	(258361, '2020-07-01', 176164),
	(258361, '2020-08-01', 145396),
	(258361, '2020-09-01', 145006),
	(258361, '2020-10-01', 174874),
	(258361, '2020-11-01', 205991),
	(258361, '2020-12-01', 187554),
	(258361, '2021-01-01', 218842),
	(258361, '2021-02-01', 271853),
	(258361, '2021-03-01', 188271),
	(258361, '2021-04-01', 147540),
	(258361, '2021-05-01', 136939),
	(258361, '2021-06-01', 106754),
	(258361, '2021-07-01', 111174),
	(258361, '2021-08-01', 122407),
	(258361, '2021-09-01', 109648),
	(258361, '2021-10-01', 120438),
	(258361, '2021-11-01', 123795),
	(258361, '2021-12-01', 127881),
	(258361, '2022-01-01', 124173),
	(258361, '2022-02-01', 142292),
	(258361, '2022-03-01', 146658),
	(258361, '2022-04-01', 116595),
	(258361, '2022-05-01', 105605),
	(258361, '2022-06-01', 87397);
